image:
- Visual Studio 2017
- Ubuntu1804
environment:
  APPVEYOR_YML_DISABLE_PS_LINUX: true
services:
- docker
stack: node 10
configuration: Release
install:
- sh: npm i -g gulp
- cmd: choco install cloc --no-progress
- cmd: "cloc --include-lang C#,SQL,Razor,\"Bourne Shell\",PowerShell,HTML,CSS,Sass,JavaScript,TypeScript --vcs git"
before_build:
- cmd: msbuild /t:restore
build_script:
- sh: chmod +x ./build.sh
- sh: ./build.sh
- sh: ./build.sh tag dev
- sh: docker images
# - sh: ./build.sh push dev
- cmd: msbuild bitwarden-server.sln /verbosity:minimal /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"
test_script:
- cmd: dotnet test .\test\Core.Test\Core.Test.csproj --configuration Debug --no-build
